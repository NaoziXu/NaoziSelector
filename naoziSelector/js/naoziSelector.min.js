(function(f){var m=document.scripts;var j;for(var g=0;g<m.length;g++){if(m[g].src.indexOf("naoziSelector.js")>-1||m[g].src.indexOf("naoziSelector.min.js")>-1){j=m[g].src.substring(0,m[g].src.lastIndexOf("/")+1);break}}var b=j.substring(0,j.length-3)+"css/naoziSelector.css";var n=document.getElementsByTagName("link");var k=false;for(var g=0;g<n.length;g++){if(n[g].href.indexOf("naoziSelector.css")>-1){k=true;break}}if(!k){f("<link>").attr({rel:"stylesheet",type:"text/css",href:b}).appendTo("head")}var e={data:{dataArray:new Array(),displayProperty:""},tabs:{tabDataArray:new Array(),tabDispalyProperty:""},sievingRules:function(r,i){return false},extraElementPropertys:new Array(),changeInputValue:true,inputMemoryOn:true,hideScroll:false,lowerHeightIfNotMax:true,dataSearch:{isOn:false,dataSearchRules:function(i,r){return false}},parentElement:f(document.body),position:{offsetX:0,offsetY:0},mainContentWidth:400,searchContentWidth:200,mainContentHeight:265,searchContentHeight:265,mainContentColumn:5,searchContentColumn:2,mainContentMargin:{marginX:1.8,marginY:1.8},searchContentMargin:{marginX:3.5,marginY:3},mainTabsFontSize:13,mainContentFontSize:13,searchContentFontSize:13,callBackFunction:function(i){}};var a=function(r,w,v,s){r.find("li").remove();for(var t=0;t<w.length;t++){var u=w[t];d(r,u,s);if(u[s.data.displayProperty]===v){r.find("li").eq(t).addClass("open")}}q(r,"main",s)};var q=function(i,s,r){if(s=="main"){i.find("li").css({width:(100-(r.mainContentColumn+1)*r.mainContentMargin.marginX)/r.mainContentColumn+"%","margin-left":r.mainContentMargin.marginX+"%","margin-bottom":r.mainContentMargin.marginY+"%","font-size":r.mainContentFontSize})}else{i.find("li").css({width:(100-(r.searchContentColumn+1)*r.searchContentMargin.marginX)/r.searchContentColumn+"%","margin-left":r.searchContentMargin.marginX+"%","margin-bottom":r.searchContentMargin.marginY+"%","font-size":r.searchContentFontSize})}};var d=function(i,u,t){var r="<li class='naoziSelectorContentItem'";for(var s=0;s<t.extraElementPropertys.length;s++){r+=(t.extraElementPropertys[s].elementProperty+"='"+u[t.extraElementPropertys[s].dataProperty]+"'")}r+=">"+u[t.data.displayProperty]+"</li>";i.append(r)};var c=function(r,i){r.bind("click",function(){r.removeClass("open");f(this).addClass("open");if(i.changeInputValue){i.hostElement.val(f(this).text())}i.callBackFunction(this)})};var l=function(r,i){if(i=="show"){r.slideDown(100)}else{r.slideUp(100)}};var p=function(r,s,i){if(i.hideScroll&&r[0].scrollHeight>r[0].clientHeight){if(s=="main"){r.css({"max-width":i.mainContentWidth+h})}else{r.css({"max-width":i.searchContentWidth+h})}}else{if(s=="main"){r.css({"max-width":i.mainContentWidth})}else{r.css({"max-width":i.searchContentWidth})}}};var h=o();function o(){var s,i,r=document.createElement("DIV");r.style.cssText="position:absolute; top:-1000px; width:100px; height:100px; overflow:hidden;";s=document.body.appendChild(r).clientWidth;r.style.overflowY="scroll";i=r.clientWidth;document.body.removeChild(r);return s-i}f.fn.extend({naoziSelector:function(A){var t="";var B=f.extend({},e,A);B.hostElement=f(this);var r=new Array();if(B.tabs.tabDataArray.length==0){r.push(B.data.dataArray)}else{for(var w=0;w<B.tabs.tabDataArray.length;w++){var y=new Array();for(var v=0;v<B.data.dataArray.length;v++){if(B.sievingRules(B.tabs.tabDataArray[w],B.data.dataArray[v])){y.push(B.data.dataArray[v])}}r.push(y)}}var u=f("<div class='naoziSelectorMain' style='display:none'></div>");f(B.parentElement).append(u);f(u).append('<div class="main"><div class="top"><ul></ul></div><div class="close"></div><div class="content"></div></div>');if(B.tabs.tabDataArray.length==0){f(u).find(".main .close").addClass("naoziSelectorDisplayNone");f(u).find(".main .content").append("<ul index='0'></ul>");a(f(u).find(".main .content ul").eq(0),r[0],t,B);f(u).find(".main .content").css({"border-top":0})}else{for(var w=0;w<B.tabs.tabDataArray.length;w++){f(u).find(".main .content").append("<ul index='"+w+"'></ul>");a(f(u).find(".main .content ul").eq(w),r[w],t,B);if(w>0){f(u).find(".main .content ul").eq(w).addClass("naoziSelectorDisplayNone")}}}c(f(u).find(".main .content ul li"),B);f(u).find(".main .content ul li").bind("click",function(){t=B.hostElement.val()});f(u).css({"max-width":B.mainContentWidth,left:B.hostElement.offset().left+B.position.offsetX,top:(B.hostElement.offset().top+B.hostElement.height()+10+B.position.offsetY)});q(f(u).find(".main .content"),"main",B);p(f(u).find(".main .content"),"main",B);if(B.lowerHeightIfNotMax){f(u).find(".main .content").css({"max-height":B.mainContentHeight})}else{f(u).find(".main .content").css({height:B.mainContentHeight})}if(B.tabs.tabDataArray.length==0){f(u).find(".main .content ul").css({"padding-top":"0px"})}else{f(u).find(".main .content ul").css({"padding-top":B.mainContentMargin.marginY+"%"})}for(var w=0;w<B.tabs.tabDataArray.length;w++){f(u).find(".main .top ul").append("<li class='naoziSelectorTopItem' index='"+w+"'>"+B.tabs.tabDataArray[w][B.tabs.tabDispalyProperty]+"</li>");if(w==0){f(u).find(".main .top ul li").addClass("open")}}f(u).find(".main .top ul li").bind("click",function(){f(this).addClass("open").siblings().removeClass("open");f(u).find(".main .content ul").eq(f(this).attr("index")).removeClass("naoziSelectorDisplayNone").siblings().addClass("naoziSelectorDisplayNone");p(f(u).find(".main .content"),"main",B)});f(u).find(".main .top ul").css({"max-width":f(u).width()-20});f(u).find(".main .top ul li").css({"font-size":B.mainTabsFontSize});var s=f("");if(B.dataSearch.isOn){s=f("<div class='naoziSelectorSearch' style='display:none'></div>");f(s).css({"max-width":B.searchContentWidth,left:B.hostElement.offset().left+B.position.offsetX,top:(B.hostElement.offset().top+B.hostElement.height()+10+B.position.offsetY)});f(B.parentElement).append(s);f(s).append('<div class="main"><div class="content"><ul></ul></div></div>');if(B.lowerHeightIfNotMax){f(s).find(".main .content").css({"max-height":B.searchContentHeight})}else{f(s).find(".main .content").css({height:B.searchContentHeight})}f(s).find(".main .content ul").css({"padding-top":B.searchContentMargin.marginY+"%"});B.hostElement.keyup(function(){var E=B.hostElement.val();if(E==""){l(f(s),"hide");l(f(u),"show");return}f(s).find(".main .content ul li").remove();var H=new Array();for(var D=0;D<r.length;D++){var G=r[D];for(var C=0;C<G.length;C++){var F=G[C];if(B.dataSearch.dataSearchRules(F,E)==true){d(f(s).find(".main .content ul"),F,B);H.push(F);if(F[B.data.displayProperty]===t){f(s).find(".main .content ul li").eq(H.length).addClass("open")}}}}p(f(s).find(".main .content"),"search",B);q(f(s).find(".main .content"),"search",B);if(E!=""){l(f(u),"hide");l(f(s),"show")}c(f(s).find(".main .content ul li"),B);f(s).find(".main .content ul li").bind("click",function(){t=B.hostElement.val();z=true});f(s).find(".main .content ul li").bind("click",function(){f(u).find(".main .top ul li").removeClass("open");var K;for(var J=0;J<H.length;J++){if(f(this).text()==H[J][B.data.displayProperty]){K=H[J];break}}if(B.tabs.tabDataArray.length==0){p(f(u).find(".main .content"),"main",B);f(u).find(".main .content ul li").removeClass("open");for(var I=0;I<r[0].length;I++){if(r[0][I][B.data.displayProperty]==f(this).text()){f(u).find(".main .content ul").eq(0).find("li").eq(I).addClass("open");break}}}else{for(var J=0;J<B.tabs.tabDataArray.length;J++){if(B.sievingRules(B.tabs.tabDataArray[J],K)==true){f(u).find(".main .top ul li").eq(J).addClass("open").siblings().removeClass("open");f(u).find(".main .content ul").eq(J).removeClass("naoziSelectorDisplayNone").siblings().addClass("naoziSelectorDisplayNone");p(f(u).find(".main .content"),"main",B);f(u).find(".main .content ul li").removeClass("open");for(var I=0;I<r[J].length;I++){if(r[J][I][B.data.displayProperty]==f(this).text()){f(u).find(".main .content ul").eq(J).find("li").eq(I).addClass("open");break}}break}}}})})}var x=null;var z=true;f(document).click(function(C){var i=f(C.target);if((B.inputMemoryOn&&i.closest(f(u)).length<=0&&i.closest(f(s)).length<=0)||i.closest(f(u).find(".main .close")).length>0){B.hostElement.val(t)}if((i.closest(f(u)).length>0&&i.closest(f(u).find(".main .close")).length<=0&&(!i.hasClass("naoziSelectorContentItem")))||i.closest(B.hostElement).length>0){B.hostElement.select()}if((i.closest(f(u)).length>0&&i.closest(f(u).find(".main .close")).length<=0&&(!i.hasClass("naoziSelectorContentItem")))||i.closest(B.hostElement).length>0){l(f(u),"show");if(z){p(f(u).find(".main .content"),"main",B);z=false}}else{l(f(u),"hide")}if(i.closest(f(s)).length>0&&(!i.hasClass("naoziSelectorContentItem"))){l(f(s),"show")}else{l(f(s),"hide")}});f(window).resize(function(){f(u).css({left:B.hostElement.offset().left+B.position.offsetX,top:(B.hostElement.offset().top+B.hostElement.height()+10+B.position.offsetY)});f(s).css({left:B.hostElement.offset().left+B.position.offsetX,top:(B.hostElement.offset().top+B.hostElement.height()+10+B.position.offsetY)});f(u).find(".main .top ul").css({"max-width":f(u).width()-20})})}})})(jQuery);